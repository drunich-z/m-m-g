(()=>{"use strict";var e={804:(e,t,n)=>{n.r(t)},346:(e,t,n)=>{n.r(t)},88:(e,t,n)=>{n.r(t)},686:(e,t,n)=>{n.r(t)},981:(e,t,n)=>{n.r(t)},144:(e,t,n)=>{n.r(t)},372:(e,t,n)=>{n.r(t)},397:(e,t,n)=>{n.r(t)},356:(e,t,n)=>{n.r(t)},477:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const s=n(774);t.App=class{constructor(e){this.rootElement=e,this.game=new s.Game,this.rootElement.appendChild(this.game.element),this.classControlContainer=this.rootElement}startGame(){return i(this,void 0,void 0,(function*(){const e=yield fetch("./images.json"),t=(yield e.json())[0],n=t.images.map((e=>`${t.category}/${e}`));this.game.newGame(n)}))}stopGame(){this.game.finishGame()}isCurrentGameIsRunning(){return this.game.isGameIsRunning()}show(){this.game.element.classList.remove("hidden")}hide(){this.game.element.classList.add("hidden")}}},70:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AboutGame=void 0;const i=n(92);n(804);class s extends i.BaseComponent{constructor(){super("div",["about-game-container"]),this.classControlContainer=this.element;const e=document.createElement("img");e.setAttribute("src","./assets/resource/about_pointer_circles.svg"),e.classList.add("about-picture"),e.setAttribute("alt","About"),this.element.appendChild(e)}show(){this.element.classList.remove("hidden")}hide(){this.element.classList.add("hidden")}}t.AboutGame=s},92:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}removeAllChilds(){for(;this.element.firstChild;)this.element.lastChild&&this.element.removeChild(this.element.lastChild)}addChild(e="div",t=[],n=""){const i=document.createElement(e);i.classList.add(...t),i.innerHTML=n,this.element.appendChild(i)}}},39:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BestScore=void 0,n(346);const i=n(92),s=n(586);class o extends i.BaseComponent{constructor(){super("div",["best-score-container","hidden"]),this.classControlContainer=this.element}show(e){this.removeAllChilds(),this.element.classList.remove("hidden");const t=s.createDOMElement("ul",["best-score-list"]);this.element.appendChild(t);for(let n=0;n<e.length;n++){let i=this.makeListElement(e[n]);t.appendChild(i)}}hide(){this.element.classList.add("hidden")}makeListElement(e){const t=`${e.name} ${e.surname}`,n=e.email,i=e.score,o=s.createDOMElement("li"),r=s.createDOMElement("div",["player-info-container"]),a=s.createDOMElement("img",["avatar"]);a.setAttribute("src","./assets/resource/logo-score.svg"),a.setAttribute("alt","avatar");const c=s.createDOMElement("div",["name-email-container"]),d=s.createDOMElement("div",["name"],t),l=s.createDOMElement("div",["email"],n),u=s.createDOMElement("div",["score-container"]),h=s.createDOMElement("div",["score-text"],"Score:"),m=s.createDOMElement("div",["score-value"],`${i}`);return c.appendChild(d),c.appendChild(l),r.appendChild(a),r.appendChild(c),u.appendChild(h),u.appendChild(m),o.appendChild(r),o.appendChild(u),o}}t.BestScore=o},25:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0,n(88);const i=n(92);class s extends i.BaseComponent{constructor(e){super("div",["card-container"]),this.image=e,this.isFlipped=!1,this.element.innerHTML=`\n      <div class="card">\n        <div class="card__front" style="background-image: url('./images/${e}'")></div>\n        <div class="card__back"></div>\n      </div>\n    `}flipToBack(){return this.isFlipped=!0,this.flip(!0)}flipToFront(){return this.isFlipped=!1,this.flip()}showError(){this.element.classList.add("error")}showValid(){this.element.classList.add("valid")}removeError(){this.element.classList.remove("error")}removeValid(){this.element.classList.remove("valid")}flip(e=!1){return new Promise((t=>{this.element.classList.toggle("flipped",e),this.element.addEventListener("transitionend",(()=>t()),{once:!0})}))}}t.Card=s},543:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardsField=void 0,n(686);const i=n(92);class s extends i.BaseComponent{constructor(){super("div",["cards-field"]),this.cards=[]}clear(){this.cards=[],this.element.innerHTML=""}addCards(e){this.cards=e,this.cards.forEach((e=>this.element.appendChild(e.element))),setTimeout((()=>{this.cards.forEach((e=>e.flipToBack()))}),3e3)}}t.CardsField=s},123:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DBAccess=void 0;class i{connect(e,t){return n(this,void 0,void 0,(function*(){if(this.db)return this.db;let n=3;const i=indexedDB.open(e,1);return new Promise(((s,o)=>{i.onerror=i=>(n--,n?this.connect(e,t):o(i)),i.onsuccess=()=>{this.db=i.result,s(this.db)},i.onupgradeneeded=()=>{this.db=i.result,i.result.createObjectStore(t,{keyPath:"uid"}),s(this.db)}}))}))}get instance(){return this.dbAccess?this.dbAccess:this.dbAccess=new i}}t.DBAccess=i},485:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DBBestScore=void 0;const s=n(985);class o extends s.DataAccess{addFivePlayersOnStart(){this.add({uid:"zverev-and@mail.ru",name:"Andrey",surname:"Zverev",email:"zverev-and@mail.ru",score:45}),this.add({uid:"petrov@mail.ru",name:"Ivan",surname:"Petrov",email:"petrov@mail.ru",score:45}),this.add({uid:"Bob.Marley@no.woman.no.cry",name:"Bob",surname:"Marley",email:"Bob.Marley@no.woman.no.cry",score:100}),this.add({uid:"kevin.spacey@us.com",name:"Kevin",surname:"Spacey",email:"kevin.spacey@us.com",score:70}),this.add({uid:"rsschool@cool.yep",name:"Student",surname:"Number1",email:"rsschool@cool.yep",score:90})}getArrayOfFirstNSortedByScore(e=1){return i(this,void 0,void 0,(function*(){return(yield this.retrieve()).sort(((e,t)=>e.score>t.score?-1:1)).slice(0,e)}))}}t.DBBestScore=o},985:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataAccess=void 0;const s=n(123);t.DataAccess=class{constructor(e,t){this.storeName=t,this.connection=(new s.DBAccess).instance.connect(e,t)}add(e){return i(this,void 0,void 0,(function*(){const t=(yield this.connection).transaction([this.storeName],"readwrite").objectStore(this.storeName).add(e);return this.requestHandler(t)}))}retrieve(){return i(this,void 0,void 0,(function*(){const e=(yield this.connection).transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise(((t,n)=>{const i=[];e.openCursor().onsuccess=e=>{const n=e.target.result;if(!n)return t(i);i.push(n.value),n.continue()}}))}))}update(e){return i(this,void 0,void 0,(function*(){const t=(yield this.connection).transaction([this.storeName],"readwrite").objectStore(this.storeName).put(e);return this.requestHandler(t)}))}get(e){return i(this,void 0,void 0,(function*(){const t=(yield this.connection).transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);return this.requestHandler(t)}))}remove(e){return i(this,void 0,void 0,(function*(){const t=(yield this.connection).transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);return this.requestHandler(t)}))}requestHandler(e){return new Promise(((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)}))}}},774:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const s=n(6),o=n(92),r=n(25),a=n(543),c=n(843);n(981);class d extends o.BaseComponent{constructor(){super("div",["game-wrapper"]),this.isAnimation=!1,this.isGameStopped=!1,this.isGameWinned=!1,this.cardsTotalCount=0,this.cardsMatchedCount=0,this.cardsField=new a.CardsField,this.element.appendChild(this.cardsField.element),this.timer=new c.Timer}newGame(e){this.isGameStopped=!1,this.isGameWinned=!1,this.cardsTotalCount=e.length,this.cardsField.clear(),this.element.prepend(this.timer.element);const t=e.concat(e).map((e=>new r.Card(e))).sort((()=>Math.random()-.5));t.forEach((e=>{e.element.addEventListener("click",(()=>this.cardHandler(e)))})),this.cardsField.addCards(t),this.timer.startTimer()}finishGame(){this.isGameStopped=!0,this.timer.stopTimer(),this.cardsMatchedCount=0,this.activeCard=void 0,this.isAnimation=!1}isGameIsRunning(){return!this.isGameStopped}cardHandler(e){return i(this,void 0,void 0,(function*(){if(!this.isGameStopped&&!this.isAnimation&&e.isFlipped){if(this.isAnimation=!0,yield e.flipToFront(),!this.activeCard)return this.activeCard=e,void(this.isAnimation=!1);if(this.activeCard.image!=e.image)return e.showError(),this.activeCard.showError(),yield s.delay(2e3),yield Promise.all([this.activeCard.flipToBack(),e.flipToBack()]),e.removeError(),this.activeCard.removeError(),this.activeCard=void 0,void(this.isAnimation=!1);e.showValid(),this.activeCard.showValid(),this.activeCard=void 0,this.isAnimation=!1,this.cardsMatchedCount+=1,this.cardsMatchedCount===this.cardsTotalCount&&(this.isGameWinned=!0,this.finishGame())}}))}}t.Game=d},34:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0,n(144);const i=n(92);class s extends i.BaseComponent{constructor(){super("div",["header"]),this.element.innerHTML='\n      <div class="header__wrapper">\n        <div class="logo-game">\n          <img src="./assets/resource/logo-game.svg" alt="logo">\n        </div>\n        <nav class="header__nav">\n          <ul>\n            <li>\n              <a id = "control__about" class = "control__about" href="#">\n                <img src="./assets/resource/logo-about.svg" alt="logo"> \n                About Game\n              </a>\n            </li>\n            <li>\n            <a id = "control__score" class = "control__score" href="#">\n                <img src="./assets/resource/logo-score.svg" alt="logo"> \n                Best Score\n              </a>\n            </li>\n            <li>\n            <a id = "control__settings" class = "control__settings" href="#">\n                <img src="./assets/resource/logo-settings.svg" alt=""> \n                Game Settings\n              </a>\n            </li>\n          </ul>\n        </nav>\n        <div class="controls">\n          <div id="control__user" class="control__user ">\n            register new user\n          </div>\n          <div id="control__game-start" class="control__game-start ">\n            start game\n          </div>\n          <div id="control__game-stop" class="control__game-stop hidden">\n            stop game\n          </div>\n        </div>\n      </div>\n    ',this.controlPlayer=null,this.controlGameStart=null,this.controlGameStop=null,this.pointerAboutGame=null,this.pointerGameScore=null,this.pointerGameSettings=null}initAllControl(){this.controlPlayer=document.getElementById("control__user"),this.controlGameStart=document.getElementById("control__game-start"),this.controlGameStop=document.getElementById("control__game-stop"),this.pointerAboutGame=document.getElementById("control__about"),this.pointerGameScore=document.getElementById("control__score"),this.pointerGameSettings=document.getElementById("control__settings")}initNewPlayerButton(){this.controlPlayer&&this.controlPlayer.addEventListener("click",(()=>console.log("test")))}initStartGameButton(){}initStopGameButton(){}}t.Header=s},214:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0,n(372);const i=n(92),s=n(586);class o extends i.BaseComponent{constructor(){super("div",["settings-container","hidden"]),this.classControlContainer=this.element;const e=s.createDOMElement("div",["settings"],"SETTING-BLOCK HERE");this.element.appendChild(e)}show(){this.element.classList.remove("hidden")}hide(){this.element.classList.add("hidden")}}t.Settings=o},843:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0,n(397);const i=n(92);class s extends i.BaseComponent{constructor(){super("div",["game-timer"])}startTimer(){this.element.innerText="00:00";const e=Date.now();let t=0;this.timerId=setInterval((()=>{t=Date.now()-e,this.element.innerText=`${this.milisecundesToMinutesAndSeconds(t)}`}),1e3)}stopTimer(){clearInterval(this.timerId)}pauseTimer(){}getTotalTime(){return 100}milisecundesToMinutesAndSeconds(e){const t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60);return`${n<10?`0${n}`:n}:${t<10?`0${t}`:t}`}}t.Timer=s},303:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),n(356);const s=n(477),o=n(34),r=n(70),a=n(485),c=n(39),d=n(214),l=document.body,u=document.getElementById("app");if(!u)throw Error("App root element not found");const h=new a.DBBestScore("drunich-z","BestScore");h.addFivePlayersOnStart();const m=new o.Header;l.prepend(m.element),m.initAllControl();const v=new r.AboutGame;u.appendChild(v.element);const p=new c.BestScore;u.appendChild(p.element);const f=new d.Settings;u.appendChild(f.element);const g=new s.App(u);function y(){return i(this,void 0,void 0,(function*(){let e;e=yield h.getArrayOfFirstNSortedByScore(10),C(),w(),p.show(e)}))}function _(){}function C(){v.hide(),p.hide(),f.hide(),g.hide()}function w(){var e,t;g.isCurrentGameIsRunning()&&(g.stopGame(),null===(e=m.controlGameStart)||void 0===e||e.classList.remove("hidden"),null===(t=m.controlGameStop)||void 0===t||t.classList.add("hidden"))}window.onload=()=>{var e,t,n,i,s,o;null===(e=m.controlGameStart)||void 0===e||e.addEventListener("click",(()=>{var e,t;C(),g.show(),g.startGame(),null===(e=m.controlGameStart)||void 0===e||e.classList.add("hidden"),null===(t=m.controlGameStop)||void 0===t||t.classList.remove("hidden")})),null===(t=m.controlGameStop)||void 0===t||t.addEventListener("click",(()=>{var e,t;g.stopGame(),null===(e=m.controlGameStart)||void 0===e||e.classList.remove("hidden"),null===(t=m.controlGameStop)||void 0===t||t.classList.add("hidden")})),null===(n=m.controlPlayer)||void 0===n||n.addEventListener("click",_),null===(i=m.pointerGameScore)||void 0===i||i.addEventListener("click",y),null===(s=m.pointerAboutGame)||void 0===s||s.addEventListener("click",(()=>{C(),w(),v.show()})),null===(o=m.pointerGameSettings)||void 0===o||o.addEventListener("click",(()=>{C(),w(),f.show()}))}},6:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout(t,e)}))}},586:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDOMElement=void 0,t.createDOMElement=function(e="div",t=[],n=""){const i=document.createElement(e);return i.classList.add(...t),i.innerHTML=n,i}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(303)})();